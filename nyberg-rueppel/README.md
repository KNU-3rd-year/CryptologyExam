# Signature algorithm Nyberg-Rueppel

## Опис
Алгоритм підпису Ніберга-Рюппеля (Nyberg-Rueppel) є одним з криптографічних алгоритмів, що використовуються для 
цифрового підпису повідомлень. Він отримав свою назву на честь двох вчених - Каллі Ніберга (Kalle Nyberg) та 
Річарда Рюппеля (Richard Rueppel), які його розробили.

Алгоритм Ніберга-Рюппеля базується на складній задачі дискретного логарифмування в скінченних полях. 
В основі алгоритму лежить математична операція під назвою "підпис з приватним ключем" (private key signature). 
Він дозволяє підписувати повідомлення з використанням приватного ключа і перевіряти їх за допомогою відкритого ключа.

Процес підпису за алгоритмом Ніберга-Рюппеля включає наступні кроки:
- Генерація ключів: Спочатку сторона, яка бажає підписувати повідомлення, генерує приватний і відповідний йому відкритий ключі. Приватний ключ залишається секретним, тоді як відкритий ключ може бути розповсюдженим.
- Обчислення підпису: Для підписування повідомлення використовується приватний ключ. При цьому повідомлення перетворюється в числове значення (часто за допомогою хеш-функцій), і до цього числа застосовується певний математичний алгоритм для обчислення підпису.
- Перевірка підпису: Для перевірки підпису використовується відкритий ключ. Приймаючи підписане повідомлення і відповідний до нього відкритий ключ, отримувач перевіряє правильність підпису, застосовуючи відповідний математичний алгоритм.

Алгоритм Ніберга-Рюппеля відомий своєю стійкістю до атак, пов'язаних з обчисленням дискретного логарифмування. 
Він також має високу швидкодію та добру масштабованість. Однак, алгоритм вимагає великої кількості обчислювальних 
операцій, що може бути важким для обмежених пристроїв з обмеженою обчислювальною потужністю.

На сьогоднішній день існує багато інших алгоритмів підпису, таких як RSA, DSA, ECDSA, які також широко використовуються 
в практиці.

## Реалізація
У ході виконання роботи був написаний код, який реалізує алгоритм підпису Ніберга-Рюппеля на основі криптосистеми на базі дискретного логарифму (DSA).

Основні функції включають:
- generate_prime(bit_length): Генерує випадкове просте число заданої довжини бітів.
- modular_inverse(a, m): Обчислює обернене за модулем m до числа a.
- extended_gcd(a, b): Знаходить найбільший спільний дільник (gcd) двох чисел a і b за допомогою розширеного алгоритму Евкліда, разом зі значеннями x і y такими, що ax + by = gcd.
- generate_keys(): Генерує ключі для підписування і перевірки. Включає генерацію простих чисел p і q, вибір генератора g, та обчислення відкритого ключа y і приватного ключа x.
- sign(message, private_key): Підписує повідомлення за допомогою приватного ключа. Включає хешування повідомлення, вибір випадкового параметра k, обчислення r і s для підпису.
- verify(message, signature, public_key): Перевіряє підписане повідомлення з використанням публічного ключа. Перевіряє правильність параметрів підпису r і s, обчислює w, u1, u2 і v для перевірки.

## Приклад роботи
Код з прикладом роботи програми наведений у кінці файла nyberg_rueppel.py.

Цей код демонструє використання алгоритму підпису Ніберга-Рюппеля для підписування повідомлень і перевірки підписів.

Основний хід виконання коду:
- Визначається початкове повідомлення message.
- Генерується приватний ключ private_key за допомогою функції generate_keys(). Приватний ключ містить параметри p, q, g, y і x.
- Публічний ключ public_key отримується шляхом виключення останнього елемента з private_key.
- Підписується початкове повідомлення message за допомогою приватного ключа private_key за допомогою функції sign(). Отриманий підпис зберігається у змінній signature.
- Виводиться інформація про початкове повідомлення, публічний ключ та підпис.
- Перевіряється підпис для початкового повідомлення message за допомогою публічного ключа public_key за допомогою функції verify(). Результат перевірки виводиться на екран.
- Перевіряється підпис для зміненого повідомлення modified_message (яке відрізняється від початкового повідомлення) за допомогою публічного ключа public_key. Результат перевірки виводиться на екран.

```
Message: Hello, world!
Public Key: (134269765570565954695398111895871519855280811484586296853190170349883430844919, 67134882785282977347699055947935759927640405742293148426595085174941715422459, 28588911982114191201508591492410798407320041518209407021094642890888436852553, 82426410522877878687532165645317118176498466092796605374094864568575021850931)
Signature: (63495036967146915547975747819409520813872087992621686228366421137134184185508, 16544086289434987090171479467673039338670526365306782490666560002215863415364)
Verification (message): True
modified_message:  Mark Yavorskyi
Verification (modified_message): False
```